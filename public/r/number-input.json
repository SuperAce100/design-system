{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "number-input",
  "type": "registry:component",
  "title": "Number Input",
  "description": "A number input with keyboard stepping and a horizontal drag handle.",
  "dependencies": [
    "lucide-react"
  ],
  "files": [
    {
      "path": "registry/new-york/blocks/number-input/number-input.tsx",
      "content": "\"use client\";\n\nimport * as React from \"react\";\nimport { ArrowLeftRight } from \"lucide-react\";\n\nimport { cn } from \"@/lib/utils\";\n\ntype NumberInputProps = Omit<\n  React.ComponentProps<\"input\">,\n  \"type\" | \"value\" | \"defaultValue\" | \"onChange\" | \"step\" | \"min\" | \"max\" | \"inputMode\"\n> & {\n  value?: number;\n  defaultValue?: number;\n  min?: number;\n  max?: number;\n  step?: number;\n  dragSensitivity?: number;\n  icon?: React.ReactNode;\n  onValueChange?: (value: number) => void;\n};\n\nfunction getPrecision(value: number) {\n  if (!Number.isFinite(value)) {\n    return 0;\n  }\n\n  const valueAsString = value.toString().toLowerCase();\n\n  if (valueAsString.includes(\"e-\")) {\n    const exponent = Number(valueAsString.split(\"e-\")[1]);\n    return Number.isFinite(exponent) ? exponent : 0;\n  }\n\n  const decimalPart = valueAsString.split(\".\")[1];\n  return decimalPart?.length ?? 0;\n}\n\nfunction formatValue(value: number) {\n  return Number.isFinite(value) ? String(value) : \"0\";\n}\n\nfunction parseValue(raw: string) {\n  const trimmed = raw.trim();\n  if (!trimmed) {\n    return null;\n  }\n\n  const parsed = Number(trimmed);\n  return Number.isFinite(parsed) ? parsed : null;\n}\n\nfunction NumberInput({\n  className,\n  value,\n  defaultValue,\n  min,\n  max,\n  step = 1,\n  dragSensitivity = 8,\n  icon = <ArrowLeftRight className=\"size-4\" />,\n  onValueChange,\n  onBlur,\n  onClick,\n  onFocus,\n  onKeyDown,\n  disabled,\n  readOnly,\n  ...props\n}: NumberInputProps) {\n  const isControlled = value !== undefined;\n  const safeStep = step === 0 ? 1 : Math.abs(step);\n  const stepPrecision = getPrecision(safeStep);\n\n  const normalizeValue = React.useCallback(\n    (nextValue: number) => {\n      let normalized = nextValue;\n\n      if (min !== undefined) {\n        normalized = Math.max(normalized, min);\n      }\n\n      if (max !== undefined) {\n        normalized = Math.min(normalized, max);\n      }\n\n      return Number(normalized.toFixed(stepPrecision));\n    },\n    [max, min, stepPrecision]\n  );\n\n  const resolveInitialValue = React.useCallback(() => {\n    const initial = value ?? defaultValue ?? min ?? 0;\n    return normalizeValue(initial);\n  }, [defaultValue, min, normalizeValue, value]);\n\n  const committedValueRef = React.useRef<number>(resolveInitialValue());\n  const [displayValue, setDisplayValue] = React.useState<string>(() =>\n    formatValue(resolveInitialValue())\n  );\n  const [isDragging, setIsDragging] = React.useState(false);\n\n  const pointerIdRef = React.useRef<number | null>(null);\n  const dragStartXRef = React.useRef(0);\n  const dragStartValueRef = React.useRef(resolveInitialValue());\n  const bodyCursorRef = React.useRef<string | null>(null);\n  const bodyUserSelectRef = React.useRef<string | null>(null);\n\n  const applyBodyDragStyles = React.useCallback((active: boolean) => {\n    if (typeof document === \"undefined\") {\n      return;\n    }\n\n    if (active) {\n      bodyCursorRef.current = document.body.style.cursor;\n      bodyUserSelectRef.current = document.body.style.userSelect;\n      document.body.style.cursor = \"ew-resize\";\n      document.body.style.userSelect = \"none\";\n      return;\n    }\n\n    document.body.style.cursor = bodyCursorRef.current ?? \"\";\n    document.body.style.userSelect = bodyUserSelectRef.current ?? \"\";\n    bodyCursorRef.current = null;\n    bodyUserSelectRef.current = null;\n  }, []);\n\n  const commitValue = React.useCallback(\n    (nextValue: number, emit = true) => {\n      const normalized = normalizeValue(nextValue);\n      committedValueRef.current = normalized;\n      setDisplayValue(formatValue(normalized));\n\n      if (emit) {\n        onValueChange?.(normalized);\n      }\n    },\n    [normalizeValue, onValueChange]\n  );\n\n  React.useEffect(() => {\n    if (!isControlled) {\n      return;\n    }\n\n    const next = normalizeValue(value ?? committedValueRef.current);\n    committedValueRef.current = next;\n    setDisplayValue(formatValue(next));\n  }, [isControlled, normalizeValue, value]);\n\n  React.useEffect(() => {\n    if (isControlled) {\n      return;\n    }\n\n    const next = normalizeValue(committedValueRef.current);\n\n    if (next !== committedValueRef.current) {\n      committedValueRef.current = next;\n      setDisplayValue(formatValue(next));\n    }\n  }, [isControlled, normalizeValue]);\n\n  React.useEffect(() => {\n    return () => applyBodyDragStyles(false);\n  }, [applyBodyDragStyles]);\n\n  const commitFromDisplay = React.useCallback(\n    (emit = true) => {\n      const parsed = parseValue(displayValue);\n\n      if (parsed === null) {\n        setDisplayValue(formatValue(committedValueRef.current));\n        return;\n      }\n\n      commitValue(parsed, emit);\n    },\n    [commitValue, displayValue]\n  );\n\n  const handlePointerDown = (event: React.PointerEvent<HTMLDivElement>) => {\n    if (disabled || readOnly) {\n      return;\n    }\n\n    event.preventDefault();\n    pointerIdRef.current = event.pointerId;\n    dragStartXRef.current = event.clientX;\n    dragStartValueRef.current = parseValue(displayValue) ?? committedValueRef.current;\n    event.currentTarget.setPointerCapture(event.pointerId);\n    setIsDragging(true);\n    applyBodyDragStyles(true);\n  };\n\n  const handlePointerMove = (event: React.PointerEvent<HTMLDivElement>) => {\n    if (disabled || readOnly || pointerIdRef.current !== event.pointerId) {\n      return;\n    }\n\n    const deltaX = event.clientX - dragStartXRef.current;\n    const stepsMoved = deltaX / Math.max(1, dragSensitivity);\n    commitValue(dragStartValueRef.current + stepsMoved * safeStep);\n  };\n\n  const handlePointerEnd = (event: React.PointerEvent<HTMLDivElement>) => {\n    if (pointerIdRef.current !== event.pointerId) {\n      return;\n    }\n\n    pointerIdRef.current = null;\n    setIsDragging(false);\n    applyBodyDragStyles(false);\n  };\n\n  const handleKeyDown = (event: React.KeyboardEvent<HTMLInputElement>) => {\n    if (!disabled && !readOnly && (event.key === \"ArrowUp\" || event.key === \"ArrowDown\")) {\n      event.preventDefault();\n      const direction = event.key === \"ArrowUp\" ? 1 : -1;\n      const start = parseValue(displayValue) ?? committedValueRef.current;\n      commitValue(start + direction * safeStep);\n      event.currentTarget.select();\n    } else if (!disabled && !readOnly && event.key === \"Enter\") {\n      commitFromDisplay();\n      event.currentTarget.select();\n    }\n\n    onKeyDown?.(event);\n  };\n\n  return (\n    <div\n      data-slot=\"number-input\"\n      className={cn(\n        \"border-input dark:bg-input/30 flex h-10 w-full min-w-0 rounded-xl border bg-transparent text-sm shadow-md shadow-shade transition-all duration-150 ease-out hover:border-border/0 hover:bg-muted hover:shadow-none hover:duration-75\",\n        \"focus-within:border-primary focus-within:ring-primary/30 focus-within:ring-[3px]\",\n        \"aria-invalid:border-destructive aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40\",\n        disabled && \"cursor-not-allowed opacity-50\",\n        className\n      )}\n    >\n      <div\n        data-slot=\"number-input-scrubber\"\n        className={cn(\n          \"text-muted-foreground hover:text-foreground flex h-full shrink-0 items-center justify-center px-3 transition-colors touch-none select-none\",\n          disabled || readOnly ? \"cursor-not-allowed\" : \"cursor-ew-resize\",\n          isDragging && \"text-foreground\"\n        )}\n        onPointerDown={handlePointerDown}\n        onPointerMove={handlePointerMove}\n        onPointerUp={handlePointerEnd}\n        onPointerCancel={handlePointerEnd}\n        onLostPointerCapture={handlePointerEnd}\n        aria-hidden=\"true\"\n      >\n        {icon}\n      </div>\n      <input\n        data-slot=\"number-input-input\"\n        type=\"text\"\n        inputMode={safeStep % 1 === 0 ? \"numeric\" : \"decimal\"}\n        value={displayValue}\n        min={min}\n        max={max}\n        step={safeStep}\n        disabled={disabled}\n        readOnly={readOnly}\n        className={cn(\n          \"placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground h-full w-full min-w-0 bg-transparent px-4 py-2 text-right outline-none disabled:cursor-not-allowed\"\n        )}\n        onChange={(event) => setDisplayValue(event.target.value)}\n        onClick={(event) => {\n          event.currentTarget.select();\n          onClick?.(event);\n        }}\n        onFocus={(event) => {\n          onFocus?.(event);\n        }}\n        onBlur={(event) => {\n          commitFromDisplay();\n          onBlur?.(event);\n        }}\n        onKeyDown={handleKeyDown}\n        {...props}\n      />\n    </div>\n  );\n}\n\nexport { NumberInput };\n",
      "type": "registry:component",
      "target": "components/ui/number-input.tsx"
    }
  ]
}